{
  "name": "SLC-DDC (L-制御)",
  "source_file": "analog2.pdf",
  "description": "根據 analog2.pdf 中 SLC-DDC (L-制御) 功能塊原文擷取與整理之精準欄位、範圍與使用規則。",
  "fields": {
    "ASUM": {
      "desc": "瞬時值 / 單位時間內之量變換或累加",
      "type": "numeric",
      "notes": "可作為輸入或內部累加項"
    },
    "Z1": {
      "desc": "啟動指令旗標 (起動指合 Z1)",
      "type": "boolean",
      "notes": "起動條件"
    },
    "Z2": {
      "desc": "條件判斷旗標 (例如 Z2 > 0)",
      "type": "numeric_or_boolean",
      "notes": "作為判斷或分支之用"
    },
    "OUTA": {
      "desc": "輸出端 (信號出力，可指定至 SLCN.)",
      "type": "output",
      "notes": "輸出可為 1 語長或 2 語長，指定接收端"
    },
    "Si": {
      "desc": "週期 (採樣/運算週期)",
      "type": "time",
      "notes": "與 CD 一起影響時間換算"
    },
    "CD": {
      "desc": "時間單位指定 (單位變換 T 與 CD 對應)",
      "type": "enum",
      "values": {
        "0": "%/秒",
        "1": "%/分",
        "2": "%/時",
        "3": "%/日",
        "4": "%/秒",
        "5": "%/分",
        "6": "%/時",
        "7": "%/日"
      },
      "notes": "對應 time factor: {0/4:1,1/5:60,2/6:3600,3/7:86400}"
    },
    "C": {
      "desc": "算力定數 (calculation constant)",
      "type": "float",
      "range": "-0.100 ~ 1.100",
      "notes": "影響時間相關算值（濾波/比例），負值代表減算情形"
    },
    "BIAS": {
      "desc": "偏移 / 小數點位數放大因子指示",
      "type": "integer",
      "range": null,
      "notes": "例如 BIAS = 2 表示以 10^-2 (兩位小數) 為顯示單位；需與 BT/語長 搭配"
    },
    "BT": {
      "desc": "設定值 / 小數點位置指定",
      "type": "integer",
      "range": "0 ~ 999999",
      "notes": "用以指定顯示或運算時的小數位與放大倍率"
    },
    "K": {
      "desc": "出力變換係數 (scale factor)",
      "type": "float",
      "range": "0.000 ~ 1.000",
      "notes": "Y = K * △，將 2-語長算值縮放為 1-語長輸出"
    },
    "word_length": {
      "desc": "語長 (1 語長 或 2 語長)",
      "type": "enum",
      "values": {
        "1": "1-word (上限約 32000)",
        "2": "2-word (更大動態範圍)"
      },
      "notes": "若 1-word 可能溢位時採用 2-word"
    }
  },
  "operations": {
    "basic_formula": [
      "Y = K · △ (Y: 1-word 輸出算值，△: 2-word 算值或變化量)",
      "顯示值/實際值 = (內部算值 × K + BIAS) / (10^BT)  (依系統實作可能有差異)"
    ],
    "time_conversion": "time_factor = {0/4:1, 1/5:60, 2/6:3600, 3/7:86400}；計算涉及時間時務必先乘/除以 time_factor 以統一基準。",
    "sign_handling": "當 C 或某些算值為負時，系統支援負力減算，須確保語長與 BIAS 設定以避免溢位。"
  },
  "usage_rules": [
    {
      "rule": "CD 與時間基準",
      "detail": "CD 指定會改變單位換算；若 CD = 1 (%/分)，需以 60 秒為轉換係數。"
    },
    {
      "rule": "K 範圍",
      "detail": "K 必須在 0.000 ～ 1.000；使用前確認縮放後不會溢位或喪失解析度。"
    },
    {
      "rule": "C 範圍",
      "detail": "C 建議範圍 -0.100 ～ 1.100；負值代表減算用途，使用時需注意物理意義與安全性。"
    },
    {
      "rule": "BT 與 BIAS",
      "detail": "BT 用以指定小數點位置（0~999999），BIAS 為加性偏移或實作上代表小數位指示，設定時需一致。"
    },
    {
      "rule": "語長選擇",
      "detail": "若 (K × Vin_max + BIAS) 超過 1-word 範圍 (約 32000)，必須切換至 2-word 或調整參數。"
    },
    {
      "rule": "驗證流程",
      "detail": "先統一時間基準 -> 驗證 K/C/BT 範圍 -> 計算預期輸出範圍 -> 檢查語長溢位 -> 測試代表值 (0, mid, max) 顯示一致"
    }
  ],
  "examples": [
    {
      "scenario": "範例 1：算值 0~200.0 m，欲輸出顯示（示例來源 PDF）",
      "details": [
        "若 K = 1 => 輸出 0 ~ 2000 (表示內部有放大因子，例如以 0.1 單位顯示時)",
        "若 K = 0.10 => 輸出 0 ~ 200 (縮放因子)"
      ]
    },
    {
      "scenario": "範例 2：流量計 0~1000.00 m, 顯示兩位小數, CD = 2 (%/時)",
      "settings": {
        "CD": 2,
        "BIAS": 2,
        "BT": 2,
        "K": 0.01,
        "word_length": 2
      },
      "explanation": "內部 2-word 算值乘以 K=0.01 再配合 BIAS/BT 做小數位置調整，輸出為 1-word 顯示（若不溢位）。"
    }
  ],
  "validation_rules": {
    "time_factor_map": {
      "0": 1,
      "1": 60,
      "2": 3600,
      "3": 86400,
      "4": -1,
      "5": -60,
      "6": -3600,
      "7": -86400
    },
    "checks": [
      "0.0 <= K <= 1.0",
      "-0.1 <= C <= 1.1 (建議範圍，依設備手冊為準)",
      "0 <= BT <= 999999",
      "Vout_max = K * Vin_max + BIAS；若 word_length == 1, Vout_max 應 <= 32767（或系統指定上限），否則改為 2-word 或調整 K/BIAS"
    ]
  },
  "notes": [
    "本 JSON 內容基於 analog2.pdf 之直接片段擷取與逐句解析整理；若你要絕對依設備原廠規格為準，請以該設備完整手冊為最終依據。",
    "若需我把此 JSON 存成檔案 (analog_block_precise.json) 並提供下載，或產生可執行之參數驗證器/CSV 對照表，告訴我即可。"
  ],
  "generated_at": "2025-08-28T00:00:00Z"
}