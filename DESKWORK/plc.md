# PLC 全方位筆記（可存為 .md 檔）

> 前言  
> 這次我徹底整理了 PLC（可程式邏輯控制器）從基礎到進階的核心知識，依據你給的筆記，讓所有內容都有畫面感。無論是硬體結構、接線細節、邏輯指令還是實務應用流程，我都用具像化的敘述重新詮釋，確保你能像心裡描圖一樣理解自動化工控的每個步驟！

---

## 目錄

- [PLC 全方位筆記（可存為 .md 檔）](#plc-全方位筆記可存為-md-檔)
  - [目錄](#目錄)
  - [一、PLC 硬體架構 \& 接線圖像化](#一plc-硬體架構--接線圖像化)
    - [1.1 輸入/輸出模組與 COM 點](#11-輸入輸出模組與-com-點)
    - [1.2 觸點（常開 / 常閉）圖像](#12-觸點常開--常閉圖像)
  - [二、PLC 梯形圖程式邏輯](#二plc-梯形圖程式邏輯)
    - [2.1 觸點與線圈—運作視覺化](#21-觸點與線圈運作視覺化)
    - [2.2 維持與瞬間狀態—SET / RST / ONESHOT](#22-維持與瞬間狀態set--rst--oneshot)
    - [2.3 單汽缸流程文字圖像化](#23-單汽缸流程文字圖像化)
      - [雙線圈衝突（文字圖像）](#雙線圈衝突文字圖像)
  - [三、進階結構—子程序與指標](#三進階結構子程序與指標)
    - [3.1 主 / 子程序分流](#31-主--子程序分流)
    - [3.2 子程序調用—語言圖像](#32-子程序調用語言圖像)
  - [四、數值與字串運算 / 比較](#四數值與字串運算--比較)
    - [4.1 基本數值操作圖像](#41-基本數值操作圖像)
    - [4.2 數值 / 字串判斷語言化流程](#42-數值--字串判斷語言化流程)
  - [五、內部元件與記憶保存](#五內部元件與記憶保存)
  - [六、計時 / 記數 / 順序控制語言化](#六計時--記數--順序控制語言化)
    - [6.1 定時器應用](#61-定時器應用)
    - [6.2 計數器](#62-計數器)
    - [6.3 順序控制語言圖像](#63-順序控制語言圖像)
  - [七、I/O 模組、CC-LINK 與現場連線過程](#七io-模組cc-link-與現場連線過程)
  - [八、元件選擇與 Tips](#八元件選擇與-tips)
  - [九、系統項目設計完整流程語言圖](#九系統項目設計完整流程語言圖)
  - [附錄：基礎架構與電氣原理、常用元件、通訊介面、實務範例等](#附錄基礎架構與電氣原理常用元件通訊介面實務範例等)
    - [基礎架構與電氣原理](#基礎架構與電氣原理)
    - [常用元件與功能輔助](#常用元件與功能輔助)
    - [邏輯控制、計數與定時](#邏輯控制計數與定時)
    - [數值、字串運算與比較](#數值字串運算與比較)
    - [程式架構與模組化](#程式架構與模組化)
    - [通訊介面、協議與模組設定](#通訊介面協議與模組設定)
    - [實務應用範例與異常處理](#實務應用範例與異常處理)
  - [PLC 設計 / 開發標準流程（簡要）](#plc-設計--開發標準流程簡要)

---

## 一、PLC 硬體架構 & 接線圖像化

### 1.1 輸入/輸出模組與 COM 點

- **輸入（Xn）/ 輸出（Yn）點**：想像每個輸入/輸出是插在控制器上的插槽，把現場感測器或執行器的訊號導進去。
- **COM 點（公共端）**：像所有設備共用的一條回流管道，是訊號流動回家的路；沒有這一筆回家，電路就不成迴路。

範例接線流程（語意化）：

```mermaid
[+24V電源]
   │
[感測器/開關](例如，X0) ──> [PLC 輸入點]
   │                        │
[COM 公共點] <——————— ────────┘
   │
[0V 地端]
```

- _比喻_：像水流必須繞個圈回來，漏掉任何一段都會變成死水或訊號失聯。

### 1.2 觸點（常開 / 常閉）圖像

- **a 接點（常開）**：沒按像一扇關著的門，一按就打開。  
- **b 接點（常閉）**：沒按門是開著的，一按下去反而闔上。  
- 在程式中像組積木，可以隨意堆疊成複雜邏輯網路。

---

## 二、PLC 梯形圖程式邏輯

### 2.1 觸點與線圈—運作視覺化

- **觸點**（可重複使用）：想像一個條件（例如按鈕 `X0`），能同時開啟多組不同的流程大門。  
- **線圈**（輸出）：就像控制開關，只能有唯一一個最終決定者（避免重複賦值）。

### 2.2 維持與瞬間狀態—SET / RST / ONESHOT

- `SET`：像用釘書機把開關釘「開」住（保持 ON）。  
- `RST`：把釘釘子拔掉，回到「關」的狀態（RESET）。  
- `ONESHOT`（LDP / LDF）：按鈕像相機快門，只在瞬間「咔嚓」一次。  
  - `LDP(X0)`：當 `X0` 剛從 OFF 變 ON 的瞬間輸出一次（上升沿）。  
  - `LDF(X0)`：當 `X0` 剛從 ON 變 OFF 的瞬間輸出一次（下降沿）。

### 2.3 單汽缸流程文字圖像化

```mermaid
[按下啟動（Start）]
  ↓
[Y0 輸出開啟（汽缸前進）]
  ↓
[感測器回饋—汽缸到位]
  ↓
[RST 或等待下一啟動]
```

- _比喻_：像打地鼠：你按按鈕 → 地鼠（汽缸）冒頭 → 感測器回報到位 → 歸位。

#### 雙線圈衝突（文字圖像）

```mermaid
[條件 A 成立] → 通電 Y10
[條件 B 成立] → 斷電 Y10
```

- 如同一根拉繩同時被兩人拉扯，最後一個發令者說了算。需用子程序或 SET/RST 等機制化解衝突。

---

## 三、進階結構—子程序與指標

### 3.1 主 / 子程序分流

- 把大型工廠的每個工作區想像成「專屬流程」。  
- **指標（P1、P2…）**像指路牌，標註要去哪一區呼叫動作。  
- 每個子程序只處理單一任務，避免不同區塊同時下相反命令。

### 3.2 子程序調用—語言圖像

```mermaid
[主流程啟動]
  ↓
[呼叫子程序 A]（僅控制 Y10）
        ↓
[呼叫子程序 B]（僅控制 Y11）
```

- _重點_：同一輸出不會在兩處同時存在 —— 增加安全與可維護性。

---

## 四、數值與字串運算 / 比較

### 4.1 基本數值操作圖像

- **整數加減/乘除**：像帳本即時記流水帳。  
- `MOV`：把一筆數字「搬到」另一個暫存器（像翻頁抄資料）。  
- **字串操作**：像剪貼板搬名字、序號（例如 `$MOV` 移動字串）。

### 4.2 數值 / 字串判斷語言化流程

- 範例：販賣機

```mermaid
[投入金額 D0]
  ↳ 判斷 ≧ 2？（門檻）
      是 →
  [按下 2 元售貨鈕 X3]
      ↓
  [亮燈 Y13，商品發出]
```

- 可用反向條件（`LDI`）避免重複出貨，像裝一個「只一次」的保險閘。

---

## 五、內部元件與記憶保存

- **輔助繼電器（如 SM400 等）**：系統內部的隱形手，用於臨時邏輯判斷。  
- **鎖存 / 非鎖存**：
  - 鎖存（O）：斷電後仍記住狀態（非易失性設定或特殊硬體支持）。  
  - 非鎖存（X）：斷電即歸零。  
- **警報繼電器**：當特殊事件（異常）發生，觸發燈號或蜂鳴。`LEDR` 指令可清除警報。  
- **B 鏈結繼電器**：連接不同區域或機台的訊號串接。

---

## 六、計時 / 記數 / 順序控制語言化

### 6.1 定時器應用

- 低速定時器：普通碼表（較低頻率）。  
- 高速定時器：高精度運動手錶（高頻率）。  
- 累計型：像儲蓄罐，累加到設定值觸發。  
- 斷電延遲：像旅館房間退房後燈還亮一會兒。

### 6.2 計數器

- **C 指令（例如三菱）**：數次動作，例如馬達運轉次數。  
- 建議以下降沿（或 ONESHOT）觸發以避免遺漏。  
- 可自動回零或條件回零，具彈性。

### 6.3 順序控制語言圖像

```mermaid
[流程開始]
  ↓
[第一步動作]
  →[特殊條件跳出 GOEND（流程提前結束）]
  ↓
[第二步動作...]
  ↓
[最後自動歸位，重頭開始]
```

- _比喻_：桌遊闖關，走到終點可跳過剩餘流程，完成後自動回起點。

---

## 七、I/O 模組、CC-LINK 與現場連線過程

- **CC-LINK 模組**：像高速公路換乘站，設備與 PLC 串成菊花鏈。  
  - 每節要設定站號（編號）與通訊速率（波特率）。  
- 語言化設備串連圖：

```mermaid
[感測器/現場設備]—電線→[CC-LINK REMOTE I/O]—菊花鏈串接→[主 PLC]
```

- 每台設備有專屬「門牌號碼」，系統才能精準送達指令。

---

## 八、元件選擇與 Tips

- **繼電器輸出**：像手動開關，電流大但反應慢。  
- **晶體管輸出**：電子觸控，響應快但承載電流小。  
- **共陽 / 共陰（源型 / 漏型）**：快速分辨哪頭回地、哪頭接電源。  
- 進位制與記憶體：  
  - 1 字節 = 8 位，2 字節 = 1 字 (WORD)。  
  - 空間編碼像城市地址，每區域有自己的容量與門牌。

---

## 九、系統項目設計完整流程語言圖

1. 工序分析（像寫劇本，每個角色的動作都規劃好）  
2. IO 點分配 & 機型選擇（把設備分配到插孔）  
3. 畫電路圖（設計城市地圖）  
4. 實體接線 & 安裝（建設道路，東西都要對應）  
5. 硬體設備與 PLC 連結（檢查交通網路是否通暢）  
6. 寫程式 & 加註解（把說明書寫清楚）  
7. 調試 / 優化（路測、修 Bug）  
8. 提交驗收 & 撰寫操作說明（教用戶怎麼玩這座城）

---

## 附錄：基礎架構與電氣原理、常用元件、通訊介面、實務範例等

### 基礎架構與電氣原理

- **輸入端分類**：常開（a 點）、常閉（b 點）。  
- **COM 與 0V**：COM 為公共端，是回路基準，接錯會導致控制異常。  
- **SINK / SOURCE 接線**：  
  - SINK（下沉）：COM 接正極（+），訊號接地（-）為 ON（常見日系）。  
  - SOURCE（源出）：COM 接負極（-），訊號拉高（+）為 ON（歐美）。  
- **NPN / PNP 感測器**：與 SINK / SOURCE 需匹配，否則感測無效。

### 常用元件與功能輔助

- **內部與鎖存繼電器**：內部繼電器為暫時狀態，鎖存可保持斷電狀態。  
- **F 警報、B 串連繼電器**：F 用於警報，B 用於系統訊號串接。  
- **SM400 類輔助繼電器**：協助邏輯分段、臨時存放狀態。  
- **雙線圈問題**：避免在同一程式有兩處直接控制同一輸出，使用子程序或 SET/RST 分段。  
- **ONESHOT（LDP / LDF）**：上升/下降沿觸發一次性動作，常用於計數。

### 邏輯控制、計數與定時

- **計數器 C 指令**：計數事件發生次數，搭配 ONESHOT 可避免重複計數。  
- **定時器 T 指令**：低速 vs 高速、延遲與累計功能。

### 數值、字串運算與比較

- **MOV / DMOV / EMOV / $MOV**：不同資料寬度或字串搬移指令。  
- 支援整數、浮點、字串運算、16/32 位處理，並有對應比較指令（>, <, =, ≠）。

### 程式架構與模組化

- **子程序（Subroutine）**：分解複雜流程、避免重複與衝突，支援參數化呼叫。  
- **內嵌 ST（結構化文本）**：在梯形圖使用 ST 處理複雜計算或字串操作。

### 通訊介面、協議與模組設定

- **FL-net（OPCN-2）**：指定設備 IP、站號、選擇傳輸模式，使用 Configurator 設定與診斷。  
- **CC-Link**：設定正確站號、波特率、資料區位址，並驗證現場接線與參數。

### 實務應用範例與異常處理

- **限位單汽缸自動循環**：原點復歸 → 啟動 → 汽缸伸 → 前緣限位 → 縮回 → 回原點。  
- **異常警報與錯誤記錄**：用 M400 類旗標監看異常並觸發警報，同時呼叫異常處理子程序做記錄與善後。

---

## PLC 設計 / 開發標準流程（簡要）

- 明確需求分析 → IO 分配與 PLC 型號選擇 → 畫接線圖 → 現場接線安裝  
- 硬體檢查與連網 → 程式設計（梯形 + ST
